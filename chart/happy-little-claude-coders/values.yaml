# Default values for happy-little-claude-coders

image:
  repository: ghcr.io/yourorg/happy-little-claude-coders
  pullPolicy: IfNotPresent
  tag: "0.2.0"  # x-release-please-version

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

workspace:
  # List of repositories to clone (space-separated URLs in env var)
  repos:
    - "https://github.com/slopus/happy-cli.git"
  # Storage size for workspace (emptyDir)
  storageSize: 10Gi
  # Persistent storage for workspace (default: false, uses emptyDir)
  persistent: false

git:
  # Git identity configuration
  userName: "Claude Bot"
  userEmail: "claude-bot@example.com"

github:
  # GitHub authentication (interactive device flow)
  # PVC size for ~/.config/gh/ persistence
  configPvcSize: 100Mi
  # Optional: Name of secret containing GitHub token for private repos
  # Secret should have a 'token' key with the GitHub personal access token
  tokenSecretName: ""

githubApp:
  # GitHub App authentication (alternative to interactive auth)
  # Provides workspace-specific repository-scoped tokens with automatic refresh
  enabled: false
  # Name of secret containing GitHub App credentials
  # Secret must have keys: app-id, installation-id, private-key
  # See history/GITHUB_APP_SETUP_GUIDE.md for setup instructions
  secretName: ""
  # Token refresh interval in minutes (tokens expire after 60 minutes)
  # Recommended: 45 minutes (refresh before expiration)
  refreshIntervalMinutes: 45
  # Sidecar container image for token refresh
  # Uses official ghinstallation library for token generation
  sidecarImage: ghcr.io/yourorg/github-token-sidecar:latest

claude:
  # Claude Code authentication (OAuth token)
  # Name of secret containing CLAUDE_CODE_OAUTH_TOKEN
  secretName: ""
  # If empty, you must create the secret manually
  # PVC size for ~/.claude/ persistence
  configPvcSize: 100Mi

resources:
  # Resource limits and requests
  limits:
    cpu: 2000m
    memory: 4Gi
  requests:
    cpu: 500m
    memory: 1Gi

# Security context for the pod (applies to all containers)
# Following Bitnami pattern with UID/GID 1001
podSecurityContext:
  enabled: true
  fsGroup: 1001
  runAsUser: 1001
  runAsGroup: 1001
  runAsNonRoot: true

# Security context for the main workspace container
containerSecurityContext:
  enabled: true
  runAsUser: 1001
  runAsGroup: 1001
  runAsNonRoot: true
  allowPrivilegeEscalation: false
  readOnlyRootFilesystem: false  # Set to false because we need to write to /tmp and other locations
  capabilities:
    drop:
    - ALL

# Security context for the init container (clone-repos)
# Must match pod-level settings for proper file permissions
initContainerSecurityContext:
  enabled: true
  runAsUser: 1001
  runAsGroup: 1001
  runAsNonRoot: true
  allowPrivilegeEscalation: false
  readOnlyRootFilesystem: false  # Set to false because git clone needs to write
  capabilities:
    drop:
    - ALL

nodeSelector: {}

tolerations: []

affinity: {}

# Service account
serviceAccount:
  create: true
  annotations: {}
  name: ""
