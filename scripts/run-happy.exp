#!/usr/bin/expect -f

# Run happy CLI and auto-select Mobile App (option 1)
set timeout -1

# Disable timeout - keep running indefinitely
log_user 1

# Spawn happy with --no-qr flag
spawn happy --no-qr

# Wait for the authentication menu
expect {
    "How would you like to authenticate?" {
        # Send "1" followed by Enter
        send "1\r"
    }
    eof {
        puts "Happy exited before showing menu"
        exit 1
    }
}

# Keep the process running and forward all output
# Use interact to pass control and keep session alive
interact
